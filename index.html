<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>🚗💸 Crazy Car Cash (Mobile)</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #87CEEB;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        #car {
            position: absolute;
            font-size: 50px;
            transition: transform 0.2s;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .cash {
            position: absolute;
            font-size: 30px;
            animation: float 1s infinite alternate;
            z-index: 5;
        }

        @keyframes float {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        #score {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 24px;
            color: gold;
            text-shadow: 2px 2px 4px black;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 10px;
        }

        #controls {
            position: fixed;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            background: rgba(255,215,0,0.7);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            user-select: none;
            border: 2px solid black;
        }

        #upgrades {
            position: fixed;
            bottom: 100px;
            left: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            max-height: 30vh;
            overflow-y: auto;
        }

        .upgrade-btn {
            padding: 8px;
            font-family: 'Comic Sans MS', cursive;
            background: gold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .upgrade-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        #tilt-toggle {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 5px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <button id="tilt-toggle">🔛 Tilt Controls</button>
        <div id="car">🚗</div>
        <div id="score">💰: 0</div>
        
        <div id="upgrades">
            <button class="upgrade-btn" onclick="buyUpgrade('speed')">🚀 Speed Boost ($10)</button>
            <button class="upgrade-btn" onclick="buyUpgrade('wheels')">🛞 Bigger Wheels ($20)</button>
            <button class="upgrade-btn" onclick="buyUpgrade('rocket')">🔥 Rocket Mode! ($50)</button>
            <button class="upgrade-btn" onclick="buyUpgrade('magnet')">🧲 Cash Magnet ($30)</button>
        </div>
        
        <div id="controls">
            <div class="control-btn" id="up-btn">⬆️</div>
            <div class="control-btn" id="left-btn">⬅️</div>
            <div class="control-btn" id="down-btn">⬇️</div>
            <div class="control-btn" id="right-btn">➡️</div>
        </div>
    </div>

    <script>
        // Game state
        let score = 0;
        let carSpeed = 5;
        let isRocketMode = false;
        let useTiltControls = false;
        let cashMagnetRadius = 0;
        let lastCashSpawn = 0;
        let cashElements = [];
        let beta = 0;
        let gamma = 0;

        // DOM elements
        const car = document.getElementById('car');
        const scoreDisplay = document.getElementById('score');
        const tiltToggle = document.getElementById('tilt-toggle');
        
        // Initialize controls
        document.getElementById('up-btn').addEventListener('touchstart', () => moveCar(0, -1));
        document.getElementById('left-btn').addEventListener('touchstart', () => moveCar(-1, 0));
        document.getElementById('down-btn').addEventListener('touchstart', () => moveCar(0, 1));
        document.getElementById('right-btn').addEventListener('touchstart', () => moveCar(1, 0));
        
        // Tilt controls toggle
        tiltToggle.addEventListener('click', toggleTiltControls);
        
        // Tilt control handler
        function handleOrientation(event) {
            if (!useTiltControls) return;
            
            beta = event.beta;  // -180 to 180 (front/back tilt)
            gamma = event.gamma; // -90 to 90 (left/right tilt)
            
            // Limit the range to prevent extreme movements
            const maxTilt = 30;
            beta = Math.max(-maxTilt, Math.min(maxTilt, beta));
            gamma = Math.max(-maxTilt, Math.min(maxTilt, gamma));
            
            // Move car based on tilt
            moveCar(gamma/maxTilt, beta/maxTilt);
        }
        
        function toggleTiltControls() {
            useTiltControls = !useTiltControls;
            tiltToggle.textContent = useTiltControls ? "📱 Tilt On" : "🔛 Tilt Controls";
            
            if (useTiltControls) {
                window.addEventListener('deviceorientation', handleOrientation);
            } else {
                window.removeEventListener('deviceorientation', handleOrientation);
            }
        }
        
        // Movement function
        function moveCar(xDir, yDir) {
            const carRect = car.getBoundingClientRect();
            const newX = carRect.left + (xDir * carSpeed);
            const newY = carRect.top + (yDir * carSpeed);
            
            // Keep car within bounds
            if (newX > 0 && newX < window.innerWidth - carRect.width) {
                car.style.left = `${newX}px`;
            }
            
            if (newY > 0 && newY < window.innerHeight - carRect.height) {
                car.style.top = `${newY}px`;
            }
            
            // Wobble effect!
            car.style.transform = `translate(-50%, -50%) rotate(${Math.random() * 10 - 5}deg)`;
            
            // Check for cash collection
            checkCashCollection();
        }
        
        // Cash spawning
        function spawnCash() {
            const now = Date.now();
            if (now - lastCashSpawn < 1000) return; // Limit spawn rate
            
            lastCashSpawn = now;
            const cash = document.createElement('div');
            cash.className = 'cash';
            cash.innerHTML = ['💵','💰','💲','💴','💶'][Math.floor(Math.random() * 5)];
            
            const x = Math.random() * (window.innerWidth - 40);
            const y = Math.random() * (window.innerHeight - 40);
            cash.style.left = `${x}px`;
            cash.style.top = `${y}px`;
            
            document.body.appendChild(cash);
            cashElements.push(cash);
            
            // Remove cash after 10 seconds if not collected
            setTimeout(() => {
                if (cash.parentNode) {
                    cash.remove();
                    cashElements = cashElements.filter(c => c !== cash);
                }
            }, 10000);
        }
        
        // Cash collection check
        function checkCashCollection() {
            const carRect = car.getBoundingClientRect();
            const carCenter = {
                x: carRect.left + carRect.width/2,
                y: carRect.top + carRect.height/2
            };
            
            cashElements.forEach((cash, index) => {
                const cashRect = cash.getBoundingClientRect();
                const cashCenter = {
                    x: cashRect.left + cashRect.width/2,
                    y: cashRect.top + cashRect.height/2
                };
                
                // Calculate distance
                const dx = carCenter.x - cashCenter.x;
                const dy = carCenter.y - cashCenter.y;
                const distance = Math.sqrt(dx*dx + dy*dy);
                
                // Magnet effect
                if (cashMagnetRadius > 0 && distance < cashMagnetRadius * 2) {
                    const pullStrength = 0.1;
                    cash.style.left = `${cashRect.left + dx * pullStrength}px`;
                    cash.style.top = `${cashRect.top + dy * pullStrength}px`;
                }
                
                // Collection check
                if (distance < 40) {
                    collectCash(cash, index);
                }
            });
        }
        
        function collectCash(cash, index) {
            // Remove cash
            cash.remove();
            cashElements.splice(index, 1);
            
            // Update score
            score += 1;
            scoreDisplay.textContent = `💰: ${score}`;
            
            // Update upgrade buttons
            updateUpgradeButtons();
            
            // Vibration feedback
            if (navigator.vibrate) navigator.vibrate(50);
            
            // Random funny effect
            if (Math.random() > 0.9) {
                const emojis = ["🤪", "😎", "🤑", "🤯", "👻"];
                car.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
                setTimeout(() => {
                    if (isRocketMode) car.innerHTML = "🚀";
                    else if (carSpeed > 10) car.innerHTML = "🏎️";
                    else car.innerHTML = "🚗";
                }, 500);
            }
        }
        
        // Upgrades system
        function buyUpgrade(type) {
            let cost = 0;
            let success = false;
            
            switch(type) {
                case 'speed':
                    cost = 10;
                    if (score >= cost) {
                        score -= cost;
                        carSpeed += 2;
                        car.innerHTML = "🏎️";
                        success = true;
                    }
                    break;
                    
                case 'wheels':
                    cost = 20;
                    if (score >= cost) {
                        score -= cost;
                        car.style.fontSize = "70px";
                        car.innerHTML = "🚙";
                        success = true;
                    }
                    break;
                    
                case 'rocket':
                    cost = 50;
                    if (score >= cost) {
                        score -= cost;
                        isRocketMode = true;
                        car.innerHTML = "🚀";
                        carSpeed += 10;
                        success = true;
                    }
                    break;
                    
                case 'magnet':
                    cost = 30;
                    if (score >= cost) {
                        score -= cost;
                        cashMagnetRadius = 150;
                        success = true;
                    }
                    break;
            }
            
            if (success) {
                scoreDisplay.textContent = `💰: ${score}`;
                updateUpgradeButtons();
                
                // Play upgrade sound if available
                try {
                    const audio = new Audio('data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU...');
                    audio.volume = 0.2;
                    audio.play();
                } catch(e) {}
            }
        }
        
        function updateUpgradeButtons() {
            const buttons = document.querySelectorAll('.upgrade-btn');
            buttons[0].disabled = score < 10;
            buttons[1].disabled = score < 20;
            buttons[2].disabled = score < 50 || isRocketMode;
            buttons[3].disabled = score < 30 || cashMagnetRadius > 0;
        }
        
        // Game loop
        function gameLoop() {
            if (Math.random() < 0.02) spawnCash();
            if (cashMagnetRadius > 0) checkCashCollection();
            requestAnimationFrame(gameLoop);
        }
        
        // Initialize game
        function initGame() {
            // Position car initially
            car.style.left = '50%';
            car.style.top = '50%';
            
            // Spawn first cash
            for (let i = 0; i < 5; i++) {
                setTimeout(spawnCash, i * 500);
            }
            
            // Start game loop
            gameLoop();
        }
        
        // Start the game when loaded
        window.onload = initGame;
    </script>
</body>
</html>
